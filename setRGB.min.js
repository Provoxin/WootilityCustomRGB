if(!document.querySelector("button[aria-label='RGB Effects'][aria-selected='true']")){document.querySelector("button[aria-label='RGB Effects']").click();throw "error: wasn't on RGB page - run the script again."}try{var ad=window.wootilityDeviceManager.activeDevice;var sc=ad.globalSettingsControl;var cp=ad.rgbControl.activeColorProfile}catch(error){if(error instanceof TypeError){window.wootilityDeviceManager.deviceManager.searchForDevices();throw "error: device not initialized - run the script again once it's been found."}else{throw error}}function ec(element){let r=element.getBoundingClientRect();return{x:r.left+r.width/2,y:r.top+r.height/2}}var ke=Array.from(document.querySelectorAll(".keyRender"));var fl=Math.min(...ke.map((k)=>{return ec(k).x}));var fr=Math.max(...ke.map((k)=>{return ec(k).x}));var ft=Math.min(...ke.map((k)=>{return ec(k).y}));var fb=Math.max(...ke.map((k)=>{return ec(k).y}));var kbOffset={x:fl,y:ft};var kbSize={x:fr-fl,y:fb-ft};var re=document.querySelector(".chakra-stack[dir='ltr']").children;var og=cp.kbdArray;if(typeof ob==="undefined"){var ob=og}cp.kbdArray=window.createLayoutArray();var m=window.getDeviceMatrix(ad.device.keyboardType);var rm=window.getKeyLayoutReference(ad.device.keyboardType,await ad.device.getlayoutType(),"rgb");if(typeof RGBFunction==="function"){var cf=RGBFunction}else{var cf=threeColorGradient;console.warn(`No custom function defined - using preset "${cf.name}"`)}for(let ro=0,en=0;ro<m.rows;ro++,en=0){for(let co=0;co<m.columns;co++){if(rm[ro][co]===null){continue}let k=re[ro].children[en].children[0].children[0];if(k===undefined){break}let kp={x:(ec(k).x-kbOffset.x)/kbSize.x,y:(ec(k).y-kbOffset.y)/kbSize.y};try{cp.kbdArray[ro][co]=rc(cf(kp,{row:ro,column:co}))}catch(error){cp.kbdArray=og;if(error instanceof RangeError){throw error.message+` at\nrow ${ro}\ncol ${co}\nx ${kp.x}\ny ${kp.y}`}else{throw error}}++en}}await ad.rgbControl.sendRgbColors(cp.kbdArray,!1);console.warn("Success! Type \"s()\" in console (without quotes) to save.\nType \"undo()\" to load your onboard profile.");async function s(){await ad.rgbControl.sendRgbColors(cp.kbdArray,!0);ob=cp.kbdArray;console.warn("Colors succesfully saved.")}async function undo(){await ad.rgbControl.sendRgbColors(ob,!1);cp.kbdArray=ob;console.warn("Onboard colors loaded.")}function rc(c){if(isNaN(c.red+c.green+c.blue)){throw new RangeError(`invalid color: {r:${c.red}, g:${c.green}, b:${c.blue}}`)}return{red:Math.max(Math.min(Math.round(c.red),255),0),green:Math.max(Math.min(Math.round(c.green),255),0),blue:Math.max(Math.min(Math.round(c.blue),255),0)}}function threeColorGradient(kp,matrixPos){return{red:kp.x*255,green:255*kp.y,blue:(1-kp.x)*255}}
//